{"title":"前端优化：网页中文字体压缩与提取","slug":"日常学习/前端优化/1. 前端优化：字体压缩与提取","date":"2021-06-19T14:54:58.000Z","updated":"2022-02-21T13:24:30.860Z","comments":true,"path":"api/articles/日常学习/前端优化/1. 前端优化：字体压缩与提取.json","excerpt":null,"covers":null,"content":"<h2 id=\"前言\"><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n<p>遇到需要自定义字体的需求时就需要向用户索要相关字体，然而从用户那里拿到的字体通常10m左右，假如用户的服务器带宽不够大，那么。。。。</p>\n<p>于是参考<a href=\"https://www.imaegoo.com/2020/chinese-font-compress/\">网页中文字体压缩（woff2）、拆分、去繁体字库，提高加载速度</a> 进行的字体&quot;安排&quot;</p>\n<h2 id=\"字体提取\"><a class=\"markdownIt-Anchor\" href=\"#字体提取\"></a> 字体提取</h2>\n<p>为了便于以后更方便的提取，于是绝对将其安装在我得腾讯云无忧主机上，这样以后在提取直接上传到服务器即可。</p>\n<table>\n<thead>\n<tr>\n<th><strong>字符集</strong></th>\n<th><strong>字数</strong></th>\n<th><strong>Unicode 编码</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=jbhz\">基本汉字</a></td>\n<td>20902字</td>\n<td>4E00-9FA5</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=jbhzbc\">基本汉字补充</a></td>\n<td>74字</td>\n<td>9FA6-9FEF</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kza\">扩展A</a></td>\n<td>6582字</td>\n<td>3400-4DB5</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kzb\">扩展B</a></td>\n<td>42711字</td>\n<td>20000-2A6D6</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kzc\">扩展C</a></td>\n<td>4149字</td>\n<td>2A700-2B734</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kzd\">扩展D</a></td>\n<td>222字</td>\n<td>2B740-2B81D</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kze\">扩展E</a></td>\n<td>5762字</td>\n<td>2B820-2CEA1</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kzf\">扩展F</a></td>\n<td>7473字</td>\n<td>2CEB0-2EBE0</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kzg\">扩展G</a></td>\n<td>4939字</td>\n<td>30000-3134A</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kxbs\">康熙部首</a></td>\n<td>214字</td>\n<td>2F00-2FD5</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=bskz\">部首扩展</a></td>\n<td>115字</td>\n<td>2E80-2EF3</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=jrhz\">兼容汉字</a></td>\n<td>477字</td>\n<td>F900-FAD9</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=jrkz\">兼容扩展</a></td>\n<td>542字</td>\n<td>2F800-2FA1D</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=puabj\">PUA(GBK)部件</a></td>\n<td>81字</td>\n<td>E815-E86F</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=bjkz\">部件扩展</a></td>\n<td>452字</td>\n<td>E400-E5E8</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=puazb\">PUA增补</a></td>\n<td>207字</td>\n<td>E600-E6CF</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=hzbh\">汉字笔画</a></td>\n<td>36字</td>\n<td>31C0-31E3</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=hzjg\">汉字结构</a></td>\n<td>12字</td>\n<td>2FF0-2FFB</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=hyzy\">汉语注音</a></td>\n<td>43字</td>\n<td>3105-312F</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=zykz\">注音扩展</a></td>\n<td>22字</td>\n<td>31A0-31BA</td>\n</tr>\n<tr>\n<td>〇</td>\n<td>1字</td>\n<td>3007</td>\n</tr>\n</tbody>\n</table>\n<p>安装<a href=\"https://github.com/fonttools/fonttools\">pyftsubset</a></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip3 <span class=\"token function\">install</span> fonttools<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<blockquote>\n<p><a href=\"https://xiaokang.me\">小康</a>的服务器自带了<code>python3.6</code>环境，因此省略的相关环境的安装。</p>\n</blockquote>\n<p>安装完成后即可通过<code>pyftsubset --help</code>命令查询相关帮助。</p>\n<p>为了方便操作这里直接套用了<a href=\"https://gist.githubusercontent.com/imaegoo/d64e5088b723c2e02c40985f55ff12db/raw/5ebd2ce49418c73459a9dfe050483409306a6c1d/sc_unicode.txt\">imaegoo</a>整理的unicodes文件(<a href=\"https://file.acs.pw/file/txt/sc_unicode.txt\">备用地址</a>)</p>\n<blockquote>\n<p>此文件包含的文字范围：简体字，latin的区间和中文标点符号</p>\n</blockquote>\n<p>工具使用方法</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pyftsubset 字体文件 --unicodes-file<span class=\"token operator\">=</span>sc_unicode文件位置<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>示例：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pyftsubset NotoSansCJKsc-Regular.otf --unicodes-file<span class=\"token operator\">=</span>sc_unicode.txt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<blockquote>\n<p>需要字体文件与<code>sc_unicode.txt</code>文件放在相同目录。</p>\n</blockquote>\n<h2 id=\"字体压缩\"><a class=\"markdownIt-Anchor\" href=\"#字体压缩\"></a> 字体压缩</h2>\n<p>字体压缩用到了谷歌的项目<a href=\"https://github.com/google/woff2\">woff2</a>，此工具会将你的字体文件压缩成woff2格式的字体文件。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone --recursive https://github.com/google/woff2.git\n<span class=\"token builtin class-name\">cd</span> woff2\n<span class=\"token function\">make</span> clean all<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<blockquote>\n<p>需要g++工具，但我的服务器居然自带了，因此相关环境安装过程也可以省略了。</p>\n</blockquote>\n<p>编译安装完成后会在目录下出现三个文件<code>woff2_decompress</code>、<code>woff2_compress</code>、<code>woff2_info</code>，我们需要将<code>woff2_compress</code>文件进行软连接，这样只需要输入<code>woff2_compress</code>即可调用该程序。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">ln</span> -s 文件 /bin/\n<span class=\"token comment\"># 例如 ln -s /opt/woff2_compress /bin/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h2 id=\"使用\"><a class=\"markdownIt-Anchor\" href=\"#使用\"></a> 使用</h2>\n<p>完成上面操作后，以后压缩字体的过程大概就是如下几步：</p>\n<ol>\n<li>\n<p>上传字体</p>\n</li>\n<li>\n<p>提取简体字</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pyftsubset 字体文件名 --unicodes-file<span class=\"token operator\">=</span>sc_unicode.txt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>压缩字体</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">woff2_compress 字体文件名<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>取出压缩后的字体文件</p>\n</li>\n</ol>\n<h2 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h2>\n<ul>\n<li><a href=\"https://www.imaegoo.com/2020/chinese-font-compress/\">网页中文字体压缩（woff2）、拆分、去繁体字库，提高加载速度</a></li>\n</ul>\n","more":"<h2 id=\"前言\"><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n<p>遇到需要自定义字体的需求时就需要向用户索要相关字体，然而从用户那里拿到的字体通常10m左右，假如用户的服务器带宽不够大，那么。。。。</p>\n<p>于是参考<a href=\"https://www.imaegoo.com/2020/chinese-font-compress/\">网页中文字体压缩（woff2）、拆分、去繁体字库，提高加载速度</a> 进行的字体&quot;安排&quot;</p>\n<h2 id=\"字体提取\"><a class=\"markdownIt-Anchor\" href=\"#字体提取\"></a> 字体提取</h2>\n<p>为了便于以后更方便的提取，于是绝对将其安装在我得腾讯云无忧主机上，这样以后在提取直接上传到服务器即可。</p>\n<table>\n<thead>\n<tr>\n<th><strong>字符集</strong></th>\n<th><strong>字数</strong></th>\n<th><strong>Unicode 编码</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=jbhz\">基本汉字</a></td>\n<td>20902字</td>\n<td>4E00-9FA5</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=jbhzbc\">基本汉字补充</a></td>\n<td>74字</td>\n<td>9FA6-9FEF</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kza\">扩展A</a></td>\n<td>6582字</td>\n<td>3400-4DB5</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kzb\">扩展B</a></td>\n<td>42711字</td>\n<td>20000-2A6D6</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kzc\">扩展C</a></td>\n<td>4149字</td>\n<td>2A700-2B734</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kzd\">扩展D</a></td>\n<td>222字</td>\n<td>2B740-2B81D</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kze\">扩展E</a></td>\n<td>5762字</td>\n<td>2B820-2CEA1</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kzf\">扩展F</a></td>\n<td>7473字</td>\n<td>2CEB0-2EBE0</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kzg\">扩展G</a></td>\n<td>4939字</td>\n<td>30000-3134A</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=kxbs\">康熙部首</a></td>\n<td>214字</td>\n<td>2F00-2FD5</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=bskz\">部首扩展</a></td>\n<td>115字</td>\n<td>2E80-2EF3</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=jrhz\">兼容汉字</a></td>\n<td>477字</td>\n<td>F900-FAD9</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=jrkz\">兼容扩展</a></td>\n<td>542字</td>\n<td>2F800-2FA1D</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=puabj\">PUA(GBK)部件</a></td>\n<td>81字</td>\n<td>E815-E86F</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=bjkz\">部件扩展</a></td>\n<td>452字</td>\n<td>E400-E5E8</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=puazb\">PUA增补</a></td>\n<td>207字</td>\n<td>E600-E6CF</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=hzbh\">汉字笔画</a></td>\n<td>36字</td>\n<td>31C0-31E3</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=hzjg\">汉字结构</a></td>\n<td>12字</td>\n<td>2FF0-2FFB</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=hyzy\">汉语注音</a></td>\n<td>43字</td>\n<td>3105-312F</td>\n</tr>\n<tr>\n<td><a href=\"https://www.qqxiuzi.cn/zh/hanzi-unicode-bianma.php?zfj=zykz\">注音扩展</a></td>\n<td>22字</td>\n<td>31A0-31BA</td>\n</tr>\n<tr>\n<td>〇</td>\n<td>1字</td>\n<td>3007</td>\n</tr>\n</tbody>\n</table>\n<p>安装<a href=\"https://github.com/fonttools/fonttools\">pyftsubset</a></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip3 <span class=\"token function\">install</span> fonttools<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<blockquote>\n<p><a href=\"https://xiaokang.me\">小康</a>的服务器自带了<code>python3.6</code>环境，因此省略的相关环境的安装。</p>\n</blockquote>\n<p>安装完成后即可通过<code>pyftsubset --help</code>命令查询相关帮助。</p>\n<p>为了方便操作这里直接套用了<a href=\"https://gist.githubusercontent.com/imaegoo/d64e5088b723c2e02c40985f55ff12db/raw/5ebd2ce49418c73459a9dfe050483409306a6c1d/sc_unicode.txt\">imaegoo</a>整理的unicodes文件(<a href=\"https://file.acs.pw/file/txt/sc_unicode.txt\">备用地址</a>)</p>\n<blockquote>\n<p>此文件包含的文字范围：简体字，latin的区间和中文标点符号</p>\n</blockquote>\n<p>工具使用方法</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pyftsubset 字体文件 --unicodes-file<span class=\"token operator\">=</span>sc_unicode文件位置<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>示例：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pyftsubset NotoSansCJKsc-Regular.otf --unicodes-file<span class=\"token operator\">=</span>sc_unicode.txt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<blockquote>\n<p>需要字体文件与<code>sc_unicode.txt</code>文件放在相同目录。</p>\n</blockquote>\n<h2 id=\"字体压缩\"><a class=\"markdownIt-Anchor\" href=\"#字体压缩\"></a> 字体压缩</h2>\n<p>字体压缩用到了谷歌的项目<a href=\"https://github.com/google/woff2\">woff2</a>，此工具会将你的字体文件压缩成woff2格式的字体文件。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone --recursive https://github.com/google/woff2.git\n<span class=\"token builtin class-name\">cd</span> woff2\n<span class=\"token function\">make</span> clean all<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<blockquote>\n<p>需要g++工具，但我的服务器居然自带了，因此相关环境安装过程也可以省略了。</p>\n</blockquote>\n<p>编译安装完成后会在目录下出现三个文件<code>woff2_decompress</code>、<code>woff2_compress</code>、<code>woff2_info</code>，我们需要将<code>woff2_compress</code>文件进行软连接，这样只需要输入<code>woff2_compress</code>即可调用该程序。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">ln</span> -s 文件 /bin/\n<span class=\"token comment\"># 例如 ln -s /opt/woff2_compress /bin/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h2 id=\"使用\"><a class=\"markdownIt-Anchor\" href=\"#使用\"></a> 使用</h2>\n<p>完成上面操作后，以后压缩字体的过程大概就是如下几步：</p>\n<ol>\n<li>\n<p>上传字体</p>\n</li>\n<li>\n<p>提取简体字</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pyftsubset 字体文件名 --unicodes-file<span class=\"token operator\">=</span>sc_unicode.txt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>压缩字体</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">woff2_compress 字体文件名<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>取出压缩后的字体文件</p>\n</li>\n</ol>\n<h2 id=\"参考\"><a class=\"markdownIt-Anchor\" href=\"#参考\"></a> 参考</h2>\n<ul>\n<li><a href=\"https://www.imaegoo.com/2020/chinese-font-compress/\">网页中文字体压缩（woff2）、拆分、去繁体字库，提高加载速度</a></li>\n</ul>\n","categories":[{"name":"前端优化","path":"api/categories/前端优化.json"}],"tags":[{"name":"字体","path":"api/tags/字体.json"}]}