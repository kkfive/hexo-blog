{"title":"一、安装Dokcer并设置镜像加速","slug":"日常学习/部署与构建/Docker/1. 安装Dokcer","date":"2021-02-27T10:26:00.000Z","updated":"2021-02-27T10:26:00.000Z","comments":true,"path":"api/articles/日常学习/部署与构建/Docker/1. 安装Dokcer.json","excerpt":null,"covers":["https://file.acs.pw/picGo/2021/2/28/aa9db60341e31b3f5df4a8b3480c94d1.png","https://file.acs.pw/picGo/2021/2/27/4ee8ed340343e6d5b82db27657dfd308.png"],"content":"<h2 id=\"docker核心架构图\"><a class=\"markdownIt-Anchor\" href=\"#docker核心架构图\"></a> Docker核心架构图</h2>\n<p><img src=\"https://file.acs.pw/picGo/2021/2/28/aa9db60341e31b3f5df4a8b3480c94d1.png\" alt=\"image-20210228175240489\" /></p>\n<h2 id=\"通过bash安装\"><a class=\"markdownIt-Anchor\" href=\"#通过bash安装\"></a> 通过Bash安装</h2>\n<blockquote>\n<p>此方法通用所有平台</p>\n</blockquote>\n<p>在测试或开发环境中 Docker 官方为了简化安装流程，提供了一套便捷的安装脚本，CentOS 系统上可以使用这套脚本安装，另外可以通过 <code>--mirror</code> 选项使用国内源进行安装：执行这个命令后，脚本就会自动的将一切准备工作做好，并且把 Docker 的稳定(stable)版本安装在系统中。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -fsSL get.docker.com -o get-docker.sh\n<span class=\"token function\">sudo</span> <span class=\"token function\">sh</span> get-docker.sh --mirror Aliyun<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>安装完成后的推荐操作</p>\n<ol>\n<li>\n<p>启动docker</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> systemctl <span class=\"token builtin class-name\">enable</span> docker\n<span class=\"token function\">sudo</span> systemctl start docker<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n</li>\n<li>\n<p>创建docker用户组</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">groupadd</span> docker<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>将当前用户加入docker组</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">usermod</span> -aG docker <span class=\"token environment constant\">$USER</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>测试docker安装是否正确</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">docker run hello-world<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n</ol>\n<h2 id=\"使用阿里云镜像加速\"><a class=\"markdownIt-Anchor\" href=\"#使用阿里云镜像加速\"></a> 使用阿里云镜像加速</h2>\n<ol>\n<li>\n<p>登录<a href=\"https://cr.console.aliyun.com/?spm=5176.12818093.custom--ali--widget-home-product-recent.dre1.1c8316d0Tujp2R\">阿里容器镜像服务</a></p>\n</li>\n<li>\n<p>查看加速地址</p>\n<p><img src=\"https://file.acs.pw/picGo/2021/2/27/4ee8ed340343e6d5b82db27657dfd308.png\" alt=\"image-20210227190110321\" /></p>\n</li>\n<li>\n<p>设置加速服务</p>\n<ul>\n<li>\n<p>创建目录</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> -p /etc/docker<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>创建文件并写入内容</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/docker/daemon.json <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\n&#123;\n  \"registry-mirrors\": [\"https://lz2nib3q.mirror.aliyuncs.com\"]\n&#125;\nEOF</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li>\n<p>重新加载及重启Docker服务</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> systemctl daemon-reload\n<span class=\"token function\">sudo</span> systemctl restart docker<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>查看镜像地址</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">docker info<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n</ol>\n","more":"<h2 id=\"docker核心架构图\"><a class=\"markdownIt-Anchor\" href=\"#docker核心架构图\"></a> Docker核心架构图</h2>\n<p><img src=\"https://file.acs.pw/picGo/2021/2/28/aa9db60341e31b3f5df4a8b3480c94d1.png\" alt=\"image-20210228175240489\" /></p>\n<h2 id=\"通过bash安装\"><a class=\"markdownIt-Anchor\" href=\"#通过bash安装\"></a> 通过Bash安装</h2>\n<blockquote>\n<p>此方法通用所有平台</p>\n</blockquote>\n<p>在测试或开发环境中 Docker 官方为了简化安装流程，提供了一套便捷的安装脚本，CentOS 系统上可以使用这套脚本安装，另外可以通过 <code>--mirror</code> 选项使用国内源进行安装：执行这个命令后，脚本就会自动的将一切准备工作做好，并且把 Docker 的稳定(stable)版本安装在系统中。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -fsSL get.docker.com -o get-docker.sh\n<span class=\"token function\">sudo</span> <span class=\"token function\">sh</span> get-docker.sh --mirror Aliyun<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>安装完成后的推荐操作</p>\n<ol>\n<li>\n<p>启动docker</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> systemctl <span class=\"token builtin class-name\">enable</span> docker\n<span class=\"token function\">sudo</span> systemctl start docker<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n</li>\n<li>\n<p>创建docker用户组</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">groupadd</span> docker<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>将当前用户加入docker组</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">usermod</span> -aG docker <span class=\"token environment constant\">$USER</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>测试docker安装是否正确</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">docker run hello-world<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n</ol>\n<h2 id=\"使用阿里云镜像加速\"><a class=\"markdownIt-Anchor\" href=\"#使用阿里云镜像加速\"></a> 使用阿里云镜像加速</h2>\n<ol>\n<li>\n<p>登录<a href=\"https://cr.console.aliyun.com/?spm=5176.12818093.custom--ali--widget-home-product-recent.dre1.1c8316d0Tujp2R\">阿里容器镜像服务</a></p>\n</li>\n<li>\n<p>查看加速地址</p>\n<p><img src=\"https://file.acs.pw/picGo/2021/2/27/4ee8ed340343e6d5b82db27657dfd308.png\" alt=\"image-20210227190110321\" /></p>\n</li>\n<li>\n<p>设置加速服务</p>\n<ul>\n<li>\n<p>创建目录</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> -p /etc/docker<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li>\n<p>创建文件并写入内容</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/docker/daemon.json <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\n&#123;\n  \"registry-mirrors\": [\"https://lz2nib3q.mirror.aliyuncs.com\"]\n&#125;\nEOF</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li>\n<p>重新加载及重启Docker服务</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> systemctl daemon-reload\n<span class=\"token function\">sudo</span> systemctl restart docker<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>查看镜像地址</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">docker info<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n</ol>\n","categories":[{"name":"Docker","path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","path":"api/tags/Docker.json"}]}