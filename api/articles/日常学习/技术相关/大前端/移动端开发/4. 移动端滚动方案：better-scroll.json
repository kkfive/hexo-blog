{"title":"移动端滚动方案：better-scroll","slug":"日常学习/技术相关/大前端/移动端开发/4. 移动端滚动方案：better-scroll","date":"2021-05-23T09:17:58.000Z","updated":"2022-02-21T06:11:10.036Z","comments":true,"path":"api/articles/日常学习/技术相关/大前端/移动端开发/4. 移动端滚动方案：better-scroll.json","excerpt":null,"covers":["https://file.acs.pw/picgo/2021/05/23/20210523171200.png"],"content":"<h2 id=\"betterscroll-是什么\"><a class=\"markdownIt-Anchor\" href=\"#betterscroll-是什么\"></a> BetterScroll 是什么</h2>\n<p>BetterScroll 是一款重点解决移动端（已支持 PC）各种滚动场景需求的插件。它的核心是借鉴的 <a href=\"https://github.com/cubiq/iscroll\">iscroll (opens new window)</a>的实现，它的 API 设计基本兼容 iscroll，在 iscroll 的基础上又扩展了一些 feature 以及做了一些性能优化。</p>\n<p>BetterScroll 是使用纯 JavaScript 实现的，这意味着它是无依赖的。</p>\n<p>官方文档：<a href=\"https://better-scroll.github.io/docs/zh-CN/guide/\">BetterScroll</a></p>\n<p>官方Demo：<a href=\"https://better-scroll.github.io/examples/#/\">示例</a></p>\n<h2 id=\"为什么不能滚动滚动原理\"><a class=\"markdownIt-Anchor\" href=\"#为什么不能滚动滚动原理\"></a> 为什么不能滚动：滚动原理</h2>\n<p><img src=\"https://file.acs.pw/picgo/2021/05/23/20210523171200.png\" alt=\"原理图\" /></p>\n<p>绿色部分为 wrapper，也就是父容器，它会有<strong>固定的高度</strong>。黄色部分为 content，它是父容器的<strong>第一个子元素</strong>，它的高度会随着内容的大小而撑高。那么，当 content 的高度不超过父容器的高度，是不能滚动的，而它一旦超过了父容器的高度，我们就可以滚动内容区了，这就是 BetterScroll 的滚动原理。</p>\n<h2 id=\"在项目中使用\"><a class=\"markdownIt-Anchor\" href=\"#在项目中使用\"></a> 在项目中使用</h2>\n<p>基本HTML结构</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>header</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-wrapper<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-content-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>动画<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-content-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>漫画<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-content-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>游戏<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-content-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>文学<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>header</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrapper<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pullup-txt<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Loading...<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>样式</p>\n<pre class=\"line-numbers language-stylus\" data-language=\"stylus\"><code class=\"language-stylus\"><span class=\"token selector\">html<span class=\"token punctuation\">,</span>body</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode\">#ccc</span></span>\n<span class=\"token selector\">.container</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative</span>\n  <span class=\"token selector\">.header-wrapper</span>\n    <span class=\"token variable-declaration\"><span class=\"token variable\">header-wrapper-height</span> <span class=\"token operator\">=</span> <span class=\"token number\">40</span><span class=\"token unit\">px</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token color\">red</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> header-wrapper-height</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">white-space</span><span class=\"token punctuation\">:</span> nowrap</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden</span>\n    <span class=\"token selector\">.header-content</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline-block</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">box-sizing</span><span class=\"token punctuation\">:</span> border-box</span>\n      <span class=\"token selector\">.header-content-item</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline-block</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">125</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> header-wrapper-height</span>\n  <span class=\"token selector\">.wrapper</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> fixed</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">top</span><span class=\"token punctuation\">:</span> <span class=\"token number\">45</span><span class=\"token unit\">px</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">bottom</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> auto</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n    <span class=\"token comment\">// background: green</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden</span>\n    <span class=\"token selector\">.content</span>\n      <span class=\"token comment\">// position: absolute</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">box-sizing</span><span class=\"token punctuation\">:</span> border-box</span>\n      <span class=\"token selector\">.pullup-txt</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">text-align</span><span class=\"token punctuation\">:</span> center</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> block</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token number\">17</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token color\">white</span></span>\n      <span class=\"token selector\">.content-item</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token color\">white</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">align-items</span><span class=\"token punctuation\">:</span> center</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">box-sizing</span><span class=\"token punctuation\">:</span> border-box</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n        <span class=\"token selector\">.content-item-avatar</span>\n          <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">px</span></span>\n          <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">px</span></span>\n          <span class=\"token selector\">img</span>\n            <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">px</span></span>\n            <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">px</span></span>\n            <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span></span>\n        <span class=\"token selector\">.content-item-body</span>\n          <span class=\"token property-declaration\"><span class=\"token property\">margin-left</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>JavaScript逻辑</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token string\">'../style/index/index.styl'</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'lib-flexible'</span>\n<span class=\"token keyword\">import</span> $ <span class=\"token keyword\">from</span> <span class=\"token string\">'jquery'</span>\n<span class=\"token comment\">// 导入better-scroll核心组件</span>\n<span class=\"token keyword\">import</span> BScroll <span class=\"token keyword\">from</span> <span class=\"token string\">'@better-scroll/core'</span>\n<span class=\"token keyword\">import</span> Pullup <span class=\"token keyword\">from</span> <span class=\"token string\">'@better-scroll/pull-up'</span>\n<span class=\"token keyword\">import</span> ObserveDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'@better-scroll/observe-dom'</span>\nBScroll<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>ObserveDOM<span class=\"token punctuation\">)</span>\nBScroll<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>Pullup<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> bodyScroll\n<span class=\"token keyword\">let</span> timer\n<span class=\"token keyword\">let</span> number <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">const</span> maxNumber <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n<span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token comment\">// 头部滑动</span>\n  <span class=\"token keyword\">let</span> headerWrapper <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.header-wrapper'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">let</span> headerScroll <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BScroll</span><span class=\"token punctuation\">(</span>headerWrapper<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n    scrollX<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    scrollY<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    probeType<span class=\"token operator\">:</span> <span class=\"token number\">3</span> <span class=\"token comment\">// listening scroll event</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 内容区滑动</span>\n  <span class=\"token keyword\">let</span> wrapper <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.wrapper'</span><span class=\"token punctuation\">)</span>\n  bodyScroll <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BScroll</span><span class=\"token punctuation\">(</span>wrapper<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n    scrollY<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    probeType<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// listening scroll event</span>\n    tap<span class=\"token operator\">:</span> <span class=\"token string\">'tap'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// 上拉加载更多示例</span>\n    pullUpLoad<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    ObserveDOM<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n\n  bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pullingUp'</span><span class=\"token punctuation\">,</span> pullingUpHandler<span class=\"token punctuation\">)</span>\n  bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">autoPullUpLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">pullingUpHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.pullup-txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span>timer<span class=\"token punctuation\">)</span>\n  timer <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span>\n    number<span class=\"token operator\">++</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>number <span class=\"token operator\">>=</span> maxNumber<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token comment\">// 假设没有数据了</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.pullup-txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'没有数据了！'</span><span class=\"token punctuation\">)</span>\n      bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">closePullUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getSaid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.pullup-txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">before</span><span class=\"token punctuation\">(</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">finishPullUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.pullup-txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getSaid</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> $<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://v1.hitokoto.cn/'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n    c\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span>hitokoto\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">text</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;div class=\"content-item\">\n            &lt;div class=\"content-item-avatar\">\n              &lt;img\n                src=\"https://cdn.jsdelivr.net/npm/kang-static@latest/avatar.jpg\"\n              />\n            &lt;/div>\n            &lt;div class=\"content-item-body\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>text<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">&lt;/div>\n          &lt;/div></span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>在线<a href=\"https://webpack.tzki.cn/\">Demo</a></p>\n<h2 id=\"使用注意点\"><a class=\"markdownIt-Anchor\" href=\"#使用注意点\"></a> 使用注意点</h2>\n<ol>\n<li>父容器需小于滚动容器才可以滚动</li>\n<li>下拉刷新，上拉加载等需要安装对应插件</li>\n</ol>\n","more":"<h2 id=\"betterscroll-是什么\"><a class=\"markdownIt-Anchor\" href=\"#betterscroll-是什么\"></a> BetterScroll 是什么</h2>\n<p>BetterScroll 是一款重点解决移动端（已支持 PC）各种滚动场景需求的插件。它的核心是借鉴的 <a href=\"https://github.com/cubiq/iscroll\">iscroll (opens new window)</a>的实现，它的 API 设计基本兼容 iscroll，在 iscroll 的基础上又扩展了一些 feature 以及做了一些性能优化。</p>\n<p>BetterScroll 是使用纯 JavaScript 实现的，这意味着它是无依赖的。</p>\n<p>官方文档：<a href=\"https://better-scroll.github.io/docs/zh-CN/guide/\">BetterScroll</a></p>\n<p>官方Demo：<a href=\"https://better-scroll.github.io/examples/#/\">示例</a></p>\n<h2 id=\"为什么不能滚动滚动原理\"><a class=\"markdownIt-Anchor\" href=\"#为什么不能滚动滚动原理\"></a> 为什么不能滚动：滚动原理</h2>\n<p><img src=\"https://file.acs.pw/picgo/2021/05/23/20210523171200.png\" alt=\"原理图\" /></p>\n<p>绿色部分为 wrapper，也就是父容器，它会有<strong>固定的高度</strong>。黄色部分为 content，它是父容器的<strong>第一个子元素</strong>，它的高度会随着内容的大小而撑高。那么，当 content 的高度不超过父容器的高度，是不能滚动的，而它一旦超过了父容器的高度，我们就可以滚动内容区了，这就是 BetterScroll 的滚动原理。</p>\n<h2 id=\"在项目中使用\"><a class=\"markdownIt-Anchor\" href=\"#在项目中使用\"></a> 在项目中使用</h2>\n<p>基本HTML结构</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>header</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-wrapper<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-content-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>动画<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-content-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>漫画<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-content-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>游戏<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>header-content-item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>文学<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>header</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrapper<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pullup-txt<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Loading...<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>样式</p>\n<pre class=\"line-numbers language-stylus\" data-language=\"stylus\"><code class=\"language-stylus\"><span class=\"token selector\">html<span class=\"token punctuation\">,</span>body</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span></span>\n  <span class=\"token property-declaration\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token hexcode\">#ccc</span></span>\n<span class=\"token selector\">.container</span>\n  <span class=\"token property-declaration\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative</span>\n  <span class=\"token selector\">.header-wrapper</span>\n    <span class=\"token variable-declaration\"><span class=\"token variable\">header-wrapper-height</span> <span class=\"token operator\">=</span> <span class=\"token number\">40</span><span class=\"token unit\">px</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token color\">red</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> header-wrapper-height</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">white-space</span><span class=\"token punctuation\">:</span> nowrap</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden</span>\n    <span class=\"token selector\">.header-content</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline-block</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">box-sizing</span><span class=\"token punctuation\">:</span> border-box</span>\n      <span class=\"token selector\">.header-content-item</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline-block</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">125</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> header-wrapper-height</span>\n  <span class=\"token selector\">.wrapper</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> fixed</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">top</span><span class=\"token punctuation\">:</span> <span class=\"token number\">45</span><span class=\"token unit\">px</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">bottom</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n    <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> auto</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n    <span class=\"token comment\">// background: green</span>\n    <span class=\"token property-declaration\"><span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden</span>\n    <span class=\"token selector\">.content</span>\n      <span class=\"token comment\">// position: absolute</span>\n      <span class=\"token property-declaration\"><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n      <span class=\"token property-declaration\"><span class=\"token property\">box-sizing</span><span class=\"token punctuation\">:</span> border-box</span>\n      <span class=\"token selector\">.pullup-txt</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">text-align</span><span class=\"token punctuation\">:</span> center</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> block</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token number\">17</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token color\">white</span></span>\n      <span class=\"token selector\">.content-item</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token color\">white</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">align-items</span><span class=\"token punctuation\">:</span> center</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">box-sizing</span><span class=\"token punctuation\">:</span> border-box</span>\n        <span class=\"token property-declaration\"><span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n        <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span>\n        <span class=\"token selector\">.content-item-avatar</span>\n          <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">px</span></span>\n          <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">px</span></span>\n          <span class=\"token selector\">img</span>\n            <span class=\"token property-declaration\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">px</span></span>\n            <span class=\"token property-declaration\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">px</span></span>\n            <span class=\"token property-declaration\"><span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token unit\">%</span></span>\n        <span class=\"token selector\">.content-item-body</span>\n          <span class=\"token property-declaration\"><span class=\"token property\">margin-left</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token unit\">px</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>JavaScript逻辑</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token string\">'../style/index/index.styl'</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'lib-flexible'</span>\n<span class=\"token keyword\">import</span> $ <span class=\"token keyword\">from</span> <span class=\"token string\">'jquery'</span>\n<span class=\"token comment\">// 导入better-scroll核心组件</span>\n<span class=\"token keyword\">import</span> BScroll <span class=\"token keyword\">from</span> <span class=\"token string\">'@better-scroll/core'</span>\n<span class=\"token keyword\">import</span> Pullup <span class=\"token keyword\">from</span> <span class=\"token string\">'@better-scroll/pull-up'</span>\n<span class=\"token keyword\">import</span> ObserveDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'@better-scroll/observe-dom'</span>\nBScroll<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>ObserveDOM<span class=\"token punctuation\">)</span>\nBScroll<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>Pullup<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> bodyScroll\n<span class=\"token keyword\">let</span> timer\n<span class=\"token keyword\">let</span> number <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">const</span> maxNumber <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n<span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token comment\">// 头部滑动</span>\n  <span class=\"token keyword\">let</span> headerWrapper <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.header-wrapper'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">let</span> headerScroll <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BScroll</span><span class=\"token punctuation\">(</span>headerWrapper<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n    scrollX<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    scrollY<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    probeType<span class=\"token operator\">:</span> <span class=\"token number\">3</span> <span class=\"token comment\">// listening scroll event</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 内容区滑动</span>\n  <span class=\"token keyword\">let</span> wrapper <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.wrapper'</span><span class=\"token punctuation\">)</span>\n  bodyScroll <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BScroll</span><span class=\"token punctuation\">(</span>wrapper<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n    scrollY<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    probeType<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// listening scroll event</span>\n    tap<span class=\"token operator\">:</span> <span class=\"token string\">'tap'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// 上拉加载更多示例</span>\n    pullUpLoad<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    ObserveDOM<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n\n  bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pullingUp'</span><span class=\"token punctuation\">,</span> pullingUpHandler<span class=\"token punctuation\">)</span>\n  bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">autoPullUpLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">pullingUpHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.pullup-txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span>timer<span class=\"token punctuation\">)</span>\n  timer <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span>\n    number<span class=\"token operator\">++</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>number <span class=\"token operator\">>=</span> maxNumber<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token comment\">// 假设没有数据了</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.pullup-txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'没有数据了！'</span><span class=\"token punctuation\">)</span>\n      bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">closePullUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getSaid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.pullup-txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">before</span><span class=\"token punctuation\">(</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      bodyScroll<span class=\"token punctuation\">.</span><span class=\"token function\">finishPullUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.pullup-txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getSaid</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> $<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://v1.hitokoto.cn/'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n    c\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">.</span>hitokoto\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">text</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;div class=\"content-item\">\n            &lt;div class=\"content-item-avatar\">\n              &lt;img\n                src=\"https://cdn.jsdelivr.net/npm/kang-static@latest/avatar.jpg\"\n              />\n            &lt;/div>\n            &lt;div class=\"content-item-body\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>text<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">&lt;/div>\n          &lt;/div></span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>在线<a href=\"https://webpack.tzki.cn/\">Demo</a></p>\n<h2 id=\"使用注意点\"><a class=\"markdownIt-Anchor\" href=\"#使用注意点\"></a> 使用注意点</h2>\n<ol>\n<li>父容器需小于滚动容器才可以滚动</li>\n<li>下拉刷新，上拉加载等需要安装对应插件</li>\n</ol>\n","categories":[{"name":"大前端","path":"api/categories/大前端.json"},{"name":"移动端开发","path":"api/categories/移动端开发.json"}],"tags":[{"name":"移动端","path":"api/tags/移动端.json"}]}